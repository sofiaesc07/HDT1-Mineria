---
title: "HT1"
author: "Stefan Quintana, Sofía Escobar, Wilfredo Gallegos"
date: "3/22/2022"
output: html_document
---

```{r, echo=FALSE}
library(readxl)
library(FrF2)
library(magrittr)
library(ungroup)
library(dplyr)
library(tidyverse)
library(ggplot2)

datos <- read.csv("movies.csv")
names(datos)
#Exploracion de datos en general
str(datos)

#Exploracion de cada variable

```

## 1) Exploración de datos

```{r, echo=FALSE}
summary(datos)
str(datos)
```

## 2) Variables cuantitativas y cualitativas


budget -> cuantitativa discreta
genres -> cualitativa nominal
homePage -> cualitativa nominal
productionCompany -> cualitativa nominal
productionCompanyCountry -> cualitativa nominal
productionCountry -> cualitativa nominal
revenue -> cuantitativa discreta
runtime -> cuantitativa discreta
video -> cualitativa nominal
director -> cualitativa nominal
actors -> cualitativa nominal
actorsPopularity -> cuantitativa discreta
actorsCharacter -> cualitativa nominal
originalTitle -> cualitativa nominal
title -> cualitativa nominal
originalLanguage -> cualitativa nominal
popularity -> cuantitativa discreta 
releaseDate -> cuantitativa discreta
voteAvg -> cuantitativa discreta 
voteCount -> cuantitativa discreta
genresAmount -> cuantitativa discreta
productionCoAomunt -> cuantitativa discreta
productionCountriesAmount -> cuantitativa discreta
actorsAmount -> cuantitativa discreta
castWomenAmount -> cuantitativa discreta
castMenAmount -> cuantitativa discreta

## 3) Revisión de normalidad en variables

### budget 
```{r, echo = FALSE}
library(nortest)
qqnorm(datos$budget)
qqline(datos$budget)

lillie.test(datos$budget)
```
### revenue
```{r, echo = FALSE}
qqnorm(datos$budget)
qqline(datos$budget)
lillie.test(datos$revenue)
```
### runtime 
```{r, echo = FALSE}
qqnorm(datos$runtime)
qqline(datos$runtime)
lillie.test(datos$runtime)
```

### popularity 
```{r, echo = FALSE}
qqnorm(datos$popularity)
qqline(datos$popularity)
lillie.test(datos$popularity)
```

### voteAvg  
```{r, echo = FALSE}
qqnorm(datos$voteAvg)
qqline(datos$voteAvg)
lillie.test(datos$voteAvg)
```

### voteCount
```{r, echo = FALSE}
qqnorm(datos$voteCount)
qqline(datos$voteCount)
lillie.test(datos$voteCount)
```
### genresAmount
```{r, echo = FALSE}
qqnorm(datos$genresAmount)
qqline(datos$genresAmount)
lillie.test(datos$genresAmount)
```
### productionCoAomunt
```{r, echo = FALSE}
qqnorm(datos$productionCoAmount)
qqline(datos$productionCoAmount)
lillie.test(datos$productionCoAmount)
```
### productionCountriesAmount 
```{r, echo = FALSE}
qqnorm(datos$productionCountriesAmount)
qqline(datos$productionCountriesAmount)
lillie.test(datos$productionCountriesAmount)
```
### actorsAmount 
```{r, echo = FALSE}
qqnorm(datos$actorsAmount)
qqline(datos$actorsAmount)
lillie.test(datos$actorsAmount)
```
### castWomenAmount 
```{r, echo = FALSE}
d1 <- as.numeric(datos$castWomenAmount)
qqnorm(d1)
qqline(d1)
lillie.test(d1)
```
### castMenAmount 
```{r, echo = FALSE}
d2 <- as.numeric(datos$castMenAmount)
qqnorm(d2)
qqline(d2)
lillie.test(d2)
```

## 4.1) ¿Cuáles son las 10 películas que contaron con más presupuesto?

```{r, echo = FALSE}
df1 <- datos[order(datos$budget, decreasing = TRUE),]
df1$title[1:10]
```

## 4.2) ¿Cuáles son las 10 películas que más ingresos tuvieron?


```{r, echo = FALSE}
df2 <- datos[order(datos$revenue, decreasing = TRUE),]
df2$title[1:10]
```


## 4.3) ¿Cuál es la película que más votos tuvo?

```{r, echo = FALSE}
df3 <- datos[order(datos$voteCount, decreasing = TRUE),]
df3$title[1:10]
```


## 4.4) ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios?

```{r}
df4 <- datos[order(datos$voteCount, decreasing = FALSE),]
df4$title[1:10]
```

## 4.5) ¿Cuántas películas se hicieron en cada año? ¿En qué año se hicieron más películas? Haga un gráfico de barras

```{r}
datos$releaseYear <- as.POSIXct(datos$releaseDate, format ="%Y-%m-%d")
datos$releaseYear <-format(datos$releaseYear, format = "%Y")
datos$releaseYear <-as.integer(datos$releaseYear, format ="%Y")
df5 <- datos %>% group_by(datos$releaseYear) %>% summarise(freq=n()) %>% ungroup()

print(as_tibble(años), n = 120)

# Get year with most movies produced
df5 %>% slice_max(freq)
ggplot(df5, aes(x=`datos$releaseYear`, y= freq, fill= freq)) + geom_bar(stat = "identity")
```

## 4.6) ¿Cuál es el género principal de las 20 películas más recientes? ¿Cuál es el género principal que predomina en el conjunto de datos? Represéntelo usando un gráfico

```{r}
df6<-datos[with(datos,order(datos$releaseYear, datos$popularity, datos$genres)),]
head(df6$genres,20)
head(df6,1)

```

## 4.7)  ¿Las películas de qué genero principal obtuvieron mayores ganancias?

```{r}
df7 <- separate_rows(datos,genres,sep="\\|") %>%
  group_by(genres) %>%
  summarize(
    revenue = sum(revenue),
    ingresos = sum(revenue) - sum(budget),
    presupuesto = sum(budget)
    )
df7
```



## 4.8) ¿La cantidad de actores influye en los ingresos de las películas?¿se han hecho películas con más actores en los últimos años?
```{r}

```


## 4.9) ¿Es posible que la cantidad de hombres y mujeres en el reparto influya en la popularidad y los ingresos de las películas?

```{r}
plot(datos[,c("popularity","revenue","castWomenAmount","castMenAmount")])

```

## 4.10) ¿Quiénes son los directores que hicieron las 20 películas mejor calificadas?

```{r}
```

## 4.11) ¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos? Haga los gráficos que necesite, histograma, diagrama de dispersión

```{r}

```

## 4.12) ¿Se asocian ciertos meses de lanzamiento con mejores ingresos?

```{r}

```

## 4.13) ¿En qué meses se han visto los lanzamientos con mejores ingresos?¿cuantas películas, en promedio, se han lanzado por mes?

```{r}

```

## 4.14) ¿Cómo se correlacionan las calificaciones con el éxito comercial?

```{r}

```

## 4.15) ¿A qué género principal pertenecen las películas más largas?

```{r}

```

hello world
